import{Q as U}from"./QSeparator.47b39938.js";import{b6 as M,e as E,j as $,R as A,v as Y,i as n,l as s,w as d,u as e,o,Y as W,Q as G,k as c,x as J,aJ as H,r as K,g as y,aQ as X,n as w,V as j,W as f,S as x,U as S,a3 as Z,a6 as ee,aU as oe}from"./index.b32dbd1f.js";import{$ as L,S as R}from"./api.752eb2c2.js";import{_ as te}from"./PageBreadcrumb.600fc173.js";import{P as ae}from"./PageCarteleraCard.34afcd63.js";import{a as N,Q as le}from"./QPagination.ae3562f7.js";import{a as se,b as re}from"./QItemSection.68145821.js";import{Q as ne}from"./QInput.0e668797.js";import"./_strapiAuthenticator.c356abdf.js";import{s as D,r as F,c as ie,g as ce,n as pe,o as ue,p as de,q as me}from"./index.8422e816.js";import{d as _e}from"./date.71f54f6b.js";import{P as fe}from"./PageShare.242ff469.js";import{_ as V}from"./StrapiDynamicZone.05cb294b.js";import{u as ve}from"./columnsSize.324d1ab1.js";import{a as ge,u as ye}from"./metaSeo.3bb09399.js";import{u as be}from"./strapiMainObj.cdc65691.js";import{u as he,Q as we}from"./QPage.ffb8be0f.js";import{Q as xe}from"./QSlideTransition.63b8cfc6.js";import{Q as Se}from"./QSpinnerDots.b41f535b.js";import"./use-dark.a8cd727b.js";import"./a11y.c5d96340.js";import"./strapi.ec3b4dbc.js";import"./selection.9ba4d7cd.js";import"./use-model-toggle.97808c35.js";import"./QDialog.90eb0bfb.js";import"./use-timeout.97c24f06.js";import"./focus-manager.387b0375.js";import"./format.c860d4da.js";import"./uid.42677368.js";import"./strapiGlobal.f3607ab2.js";import"./index.72eda645.js";import"./QNoSsr.ff9ae35e.js";import"./StrapiRichText.a7f7a61e.js";import"./use-meta.34cac53e.js";import"./global.e3cc4bf2.js";const Ce={class:"row q-col-gutter-md"},ke=c("span",{class:"sr-only"},"Mostrar",-1),Pe=c("span",{class:"sr-only"},"Modalidad",-1),Ve=c("span",{class:"sr-only"},"Tipos de eventos",-1),$e=c("span",{class:"sr-only"},"Buscar",-1),qe=["Todos","Pr\xF3ximos"],Qe=_e.formatDate(new Date,"YYYY-MM-DD"),Te=[M.ONLINE,M.PRESENCIAL,M.PRESENCIAL_Y_ONLINE];function B(){return{query:"",current:"Todos",eventType:""}}function Me(r){const i={};return r.query&&(i.titulo={$containsi:r.query.toLowerCase()}),r.current=="Pr\xF3ximos"&&(i.fecha_y_hora_de_inicio={$gte:Qe}),r.modality&&(i.modalidad={$eq:r.modality}),r.eventType&&(i.tipo_de_evento={tipo_de_evento:{$eq:r.eventType}}),i}const je=E({__name:"PageCarteleraFilters",props:{disable:{type:Boolean,default:!1}},emits:["change:filters"],setup(r,{emit:i}){const p=$(B()),b=A(null);Y(p,(_,t)=>i("change:filters",_),{deep:!0});const a=async(_,t,u)=>{if(b.value==null)try{const m=await L.$catCarteleraTipo.find({pagination:{page:0,pageSize:500},populate:{tipo_de_evento:{populate:"*"}}});t(()=>b.value=R.unpack(m).map(h=>h.tipo_de_evento))}catch{u();return}else{t(()=>{});return}};return(_,t)=>(o(),n("div",Ce,[s(N,{modelValue:p.value.current,"onUpdate:modelValue":t[0]||(t[0]=u=>p.value.current=u),label:"Mostrar",class:"col-12 col-sm-6 col-md-2 app-text-body",color:"secondary",disable:r.disable,"dropdown-icon":e(D),options:e(qe)},{default:d(()=>[ke]),_:1},8,["modelValue","disable","dropdown-icon","options"]),s(N,{modelValue:p.value.modality,"onUpdate:modelValue":t[1]||(t[1]=u=>p.value.modality=u),label:"Modalidad",clearable:"",class:"col-12 col-sm-6 col-md-2 app-text-body",color:"secondary","popup-content-class":"text-capitalize","clear-icon":e(F),disable:r.disable,"dropdown-icon":e(D),options:e(Te)},{default:d(()=>[Pe]),_:1},8,["modelValue","clear-icon","disable","dropdown-icon","options"]),s(N,{modelValue:p.value.eventType,"onUpdate:modelValue":t[2]||(t[2]=u=>p.value.eventType=u),class:"col-12 col-sm-6 col-md-3 app-text-body",color:"secondary",clearable:"","clear-icon":e(F),label:"Tipo de evento",disable:r.disable,options:e(b)||[],"dropdown-icon":e(D),onFilter:a},{"no-option":d(()=>[s(se,null,{default:d(()=>[s(re,{class:"text-grey"},{default:d(()=>[W(" No se encontraron resultados ")]),_:1})]),_:1})]),default:d(()=>[Ve]),_:1},8,["modelValue","clear-icon","disable","options","dropdown-icon"]),s(ne,{modelValue:p.value.query,"onUpdate:modelValue":t[3]||(t[3]=u=>p.value.query=u),class:"col-12 col-sm-6 col-md-5 app-text-body",label:"Buscar",placeholder:"Nombre del evento",color:"secondary",clearable:"","clear-icon":e(F),disable:r.disable,debounce:500},{append:d(()=>[s(G,{name:e(ie)},null,8,["name"])]),default:d(()=>[$e]),_:1},8,["modelValue","clear-icon","disable"])]))}}),Ne={key:0,class:"app-post-cover"},De={class:"app-post-cover__content app-content-centered"},Fe=["textContent"],Le={class:"app-content-centered col-grow column q-pb-lg"},Ie={key:0,class:"col-grow full-width"},ze={class:"row q-col-gutter-x-xl"},Ee={class:"col-shrink full-width q-pb-lg"},Ae={class:"row col-12 justify-center"},Re={key:1,class:"app-text-subtitle text-center q-py-xl"},Be={class:"col-grow full-width"},Oe={class:"q-mt-none app-helper__ul--remove-defaults row q-col-gutter-lg","aria-live":"polite","aria-labelledby":"cartelera-page-title"},Ue={async preFetch({store:r}){await he(r).load(()=>L.$pagCartelera.load({populate:{columna_1:{populate:"*"},columna_2:{populate:"*"},columna_3:{populate:"*"},columna_4:{populate:"*"},cover:{populate:"*"},titulo:{populate:"*"},seo:{populate:"*"}}}))}},$o=E({...Ue,__name:"CarteleraPage",setup(r){const i="Cartelera",p="No se encontraron eventos",b="Problemas al obtener los eventos",{strapiMainObj:a}=be();a.value!=null?ge(a.value):ye({title:i});const{colSize:_,isValid:t,colsTotal:u}=ve(a),m=$(!0),h=$(0),I=$(0);let z=B();const q=A([]);J(()=>void Q(0));function O(C){z=C,Q(0)}async function Q(C=0){m.value=!0;try{let k=["publishedAt:desc"];const P=Me(z),v=await L.$postsCartelera.find({sort:k,pagination:{page:C,pageSize:12},populate:{slug:{populate:"*"},titulo:{populate:"*"},poster:{populate:"*"},seo:{populate:{meta_descripcion:{populate:"*"}}},fecha_y_hora_de_inicio:{populate:"*"},modalidad:{populate:"*"},tipo_de_evento:{populate:{tipo_de_evento:{populate:"*"}}},lugar:{populate:"*"}},filters:P});if(v.meta&&v.meta.pagination){const l=v.meta.pagination;I.value=Math.ceil(l.total/l.pageSize),h.value=l.page}q.value=R.unpack(v)}catch{H.create({type:"negative",icon:ce,message:b})}m.value=!1}return(C,T)=>{const k=K("strapi-img");return o(),y(e(we),{class:"app-post column"},{default:d(()=>{var P,v;return[(P=e(a))!=null&&P.cover?(o(),n("div",Ne,[s(k,{"strapi-img":e(a).cover.imagen,"use-native":"","remove-native-on-fail":"",fetchpriority:"high","bg-color":"",class:"app-post-cover__background","context-menu":!1,style:X({backgroundColor:(v=e(a))==null?void 0:v.cover.color.color_hexadecimal})},null,8,["strapi-img","style"]),c("div",De,[c("h1",{class:w({"q-pa-md":!0,"app-post-h1-dense":(e(a).titulo||i).length>=50}),textContent:j(e(a)?e(a).titulo:i)},null,10,Fe),s(fe,{class:"absolute-bottom-right"})])])):f("",!0),c("div",Le,[s(te,{class:"col-shrink"}),e(a)?(o(),n("div",Ie,[c("div",ze,[e(t).col1?(o(),n("section",{key:0,class:w(e(_))},[(o(!0),n(x,null,S(e(a).columna_1,(l,g)=>(o(),y(V,{key:`strapi-col1-${g}`,"strapi-obj":l},null,8,["strapi-obj"]))),128))],2)):f("",!0),e(t).col2?(o(),n("section",{key:1,class:w(e(_))},[(o(!0),n(x,null,S(e(a).columna_2,(l,g)=>(o(),y(V,{key:`strapi-col2-${g}`,"strapi-obj":l},null,8,["strapi-obj"]))),128))],2)):f("",!0),e(t).col3?(o(),n("section",{key:2,class:w(e(_))},[(o(!0),n(x,null,S(e(a).columna_3,(l,g)=>(o(),y(V,{key:`strapi-col3-${g}`,"strapi-obj":l},null,8,["strapi-obj"]))),128))],2)):f("",!0),e(t).col4?(o(),n("section",{key:3,class:w(e(_))},[(o(!0),n(x,null,S(e(a).columna_4,(l,g)=>(o(),y(V,{key:`strapi-col4-${g}`,"strapi-obj":l},null,8,["strapi-obj"]))),128))],2)):f("",!0)]),e(u)>0?(o(),y(U,{key:0,class:"full-width q-my-xl"})):f("",!0)])):f("",!0),c("h2",{class:"sr-only"},"Lista de "+j(i)),c("div",Ee,[s(je,{disable:m.value,"onChange:filters":O},null,8,["disable"])]),s(e(xe),null,{default:d(()=>[Z(c("div",Ae,[s(e(Se),{color:"secondary",size:"3em"})],512),[[ee,m.value]])]),_:1}),e(q).length==0&&!m.value?(o(),n("p",Re,j(p))):f("",!0),c("div",Be,[c("ul",Oe,[s(oe,{appear:"",mode:"out-in","enter-active-class":"animated fadeIn"},{default:d(()=>[(o(!0),n(x,null,S(e(q),l=>(o(),n("li",{key:l.slug,class:"col-12 col-md-6"},[s(ae,{"strapi-obj":l},null,8,["strapi-obj"])]))),128))]),_:1})])]),s(e(le),{modelValue:h.value,"onUpdate:modelValue":[T[0]||(T[0]=l=>h.value=l),Q],color:"secondary",class:"self-end q-pt-md",input:"",disable:m.value,max:I.value,"icon-first":e(pe),"icon-last":e(ue),"icon-prev":e(de),"icon-next":e(me)},null,8,["modelValue","disable","max","icon-first","icon-last","icon-prev","icon-next"])])]}),_:1})}}});export{$o as default};
